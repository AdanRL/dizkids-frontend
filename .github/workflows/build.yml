

name: CI

on: [push]

jobs:
  test-and-notification:
    name: Run Test and Discord notification
    runs-on: ubuntu-latest
    steps:   
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Install dependencies
        run: npm install
      
      - name: Run linter
        run: npm run lint

      - name: Run tests
        run: npm test

      - name: Test success
        uses: rjstone/discord-webhook-notify@v1
        if: success()
        with:
          severity: info
          username: Dizkids-Front
          color: '#00ff77'
          avatarUrl: https://icons-for-free.com/download-icon-complete+done+green+success+valid+icon-1320183462969251652_512.png
          details: Test succeeded.
          webhookUrl: ${{ secrets. }}

      - name: Test failed
        uses: rjstone/discord-webhook-notify@v1
        if: failure()
        with:
          severity: error
          username: AvocaDev-Front
          color: '#ff0000'
          avatarUrl: https://icon-library.com/images/failed-icon/failed-icon-7.jpg
          details: Test failed.
          webhookUrl: ${{ secrets. }}
